#include <stdio.h>
#include <string.h>
#include <unistd.h>  
#include <stdlib.h>
#include <signal.h>

int seconds = 20;
void read_flag() {
    char flag[128];
    FILE *file = fopen("flag.txt", "r");
    if (file == NULL) {
        printf("Error: Could not open flag.txt\n");
        return;
    }
    fgets(flag, sizeof(flag), file);
    fclose(file);
    sleep(seconds); 
    printf("\033[1;34m%s",flag);
    fflush(stdout);
    exit(0);
}
void print_typing_animation(const char* message) {
    const char* colors[] = {
        "\033[31m", 
        "\033[32m", 
        "\033[33m", 
        "\033[34m", 
        "\033[35m", 
        "\033[36m"  
    };
    const char* reset = "\033[0m"; 
    int len = strlen(message);
    

    for (int i = 0; i < len; ++i) {
        printf("%s%c%s", colors[2], message[i], reset);  
        fflush(stdout); 
        usleep(100000); 
    }

}

void print_banner() {
    const char *banner[] = {
        "╔═════════════════════Author═══════════════════════╗",
        "║ ██████╗ ███████╗██╗  ██╗████████╗███████╗██████╗ ║",
        "║ ██╔══██╗██╔════╝╚██╗██╔╝╚══██╔══╝██╔════╝██╔══██╗║",
        "║ ██║  ██║█████╗   ╚███╔╝    ██║   █████╗  ██████╔╝║",
        "║ ██║  ██║██╔══╝   ██╔██╗    ██║   ██╔══╝  ██╔══██╗║",
        "║ ██████╔╝███████╗██╔╝ ██╗   ██║   ███████╗██║  ██║║",
        "║ ╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝   ╚══════╝╚═╝  ╚═╝║",
        "╚═══════════════SecuriNets Ensit═══════════════════╝",
    };

    const char *colors[] = {

        "\033[31m",  
        "\033[32m",  
        "\033[33m",  
        "\033[34m",  
        "\033[35m",  
        "\033[36m",  
    };

    int num_lines = sizeof(banner) / sizeof(banner[0]);


    printf("\033[2J\033[H");

    for (int i = 0; i < num_lines; i++) {
        printf("%s", colors[0]); 
        for (int j = 0; banner[i][j] != '\0'; j++) {
            printf("%c", banner[i][j]); 
            fflush(stdout); 
            usleep(2000); 
        }
        printf("\n");
        usleep(2000);  
    }

  
}

void print_logo() {
char *banner[] = {
    "                                          ",
    "         ***              ***             ",
    "       ****   **********  ****            ",
    "      *************************           ",
    "      **************************          ",
    "     ***************************          ",
    "     ***************************          ",
    "     ***************************          ",
    "      **************************          ",
    "      ******************** *****          ",
    "       ***  **  ****** **  ***            ",
    "         **      ***      ***             ",
    "          **      *      **               ",
    "                                          ",
    "           SecuriNets Ensit               "
};




    const char *colors[] = {
       "\033[37m",
        "\033[31m",  
        "\033[32m",  
        "\033[33m",  
        "\033[34m",  
        "\033[35m",  
        "\033[36m",  
     

    };

    int num_lines = sizeof(banner) / sizeof(banner[0]);

    for (int i = 0; i < num_lines; i++) {
        printf("%s", colors[0]);  
        for (int j = 0; banner[i][j] != '\0'; j++) {
            printf("%c", banner[i][j]);  
            fflush(stdout); 
            usleep(2000);
        }
        printf("\n         ");
        usleep(2000); 
    }
    printf("\n");
}
void vulnerable_function() {
    char buffer[100];
    printf("\033[31mSecuriNets@root:~$ ");
    fflush(stdout);
    fgets(buffer, sizeof(buffer), stdin);

    // Vulnerable printf: No format specifier
    printf(buffer);  
}

void handle_alarm(int sig) {

    exit(0);
}

int main() {
    signal(SIGALRM, handle_alarm); // Set up signal handler
    print_banner();
    print_logo();
    vulnerable_function();
    alarm(2); // Set alarm for 4 seconds
    read_flag();
    
    
    return 0;
}

